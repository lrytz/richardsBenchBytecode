/*
 * Decompiled with CFR 0_110.
 * 
 * Could not load the following classes:
 *  scala.reflect.ScalaSignature
 */
import scala.reflect.ScalaSignature;

@ScalaSignature(bytes="\u0006\u0001\u0005}a\u0001B\u0001\u0003\u0001\u0015\u0011\u0011bU2iK\u0012,H.\u001a:\u000b\u0003\r\tq\u0001P3naRLhh\u0001\u0001\u0014\u0005\u00011\u0001CA\u0004\u000b\u001b\u0005A!\"A\u0005\u0002\u000bM\u001c\u0017\r\\1\n\u0005-A!AB!osJ+g\rC\u0003\u000e\u0001\u0011\u0005a\"\u0001\u0004=S:LGO\u0010\u000b\u0002\u001fA\u0011\u0001\u0003A\u0007\u0002\u0005!9!\u0003\u0001a\u0001\n\u0003\u0019\u0012AC9vKV,7i\\;oiV\tA\u0003\u0005\u0002\b+%\u0011a\u0003\u0003\u0002\u0004\u0013:$\bb\u0002\r\u0001\u0001\u0004%\t!G\u0001\u000fcV,W/Z\"pk:$x\fJ3r)\tQR\u0004\u0005\u0002\b7%\u0011A\u0004\u0003\u0002\u0005+:LG\u000fC\u0004\u001f/\u0005\u0005\t\u0019\u0001\u000b\u0002\u0007a$\u0013\u0007\u0003\u0004!\u0001\u0001\u0006K\u0001F\u0001\fcV,W/Z\"pk:$\b\u0005C\u0004#\u0001\u0001\u0007I\u0011A\n\u0002\u0013!|G\u000eZ\"pk:$\bb\u0002\u0013\u0001\u0001\u0004%\t!J\u0001\u000eQ>dGmQ8v]R|F%Z9\u0015\u0005i1\u0003b\u0002\u0010$\u0003\u0003\u0005\r\u0001\u0006\u0005\u0007Q\u0001\u0001\u000b\u0015\u0002\u000b\u0002\u0015!|G\u000eZ\"pk:$\b\u0005C\u0004+\u0001\u0001\u0007I\u0011A\u0016\u0002\u0015\r,(O]3oiR\u001b'-F\u0001-!\t\u0001R&\u0003\u0002/\u0005\t\u0001B+Y:l\u0007>tGO]8m\u00052|7m\u001b\u0005\ba\u0001\u0001\r\u0011\"\u00012\u00039\u0019WO\u001d:f]R$6MY0%KF$\"A\u0007\u001a\t\u000fyy\u0013\u0011!a\u0001Y!1A\u0007\u0001Q!\n1\n1bY;se\u0016tG\u000fV2cA!9a\u0007\u0001a\u0001\n\u0003\u0019\u0012!C2veJ,g\u000e^%e\u0011\u001dA\u0004\u00011A\u0005\u0002e\nQbY;se\u0016tG/\u00133`I\u0015\fHC\u0001\u000e;\u0011\u001dqr'!AA\u0002QAa\u0001\u0010\u0001!B\u0013!\u0012AC2veJ,g\u000e^%eA!9a\b\u0001a\u0001\n\u0003Y\u0013\u0001\u00027jgRDq\u0001\u0011\u0001A\u0002\u0013\u0005\u0011)\u0001\u0005mSN$x\fJ3r)\tQ\"\tC\u0004\u001f\u0005\u0005\t\u0019\u0001\u0017\t\r\u0011\u0003\u0001\u0015)\u0003-\u0003\u0015a\u0017n\u001d;!\u0011\u001d1\u0005A1A\u0005\u0002\u001d\u000baA\u00197pG.\u001cX#\u0001%\u0011\u0007\u001dIE&\u0003\u0002K\u0011\t)\u0011I\u001d:bs\"1A\n\u0001Q\u0001\n!\u000bqA\u00197pG.\u001c\b\u0005C\u0003O\u0001\u0011\u0005q*A\u0006bI\u0012LE\r\\3UCN\\G#\u0002\u000eQ%RK\u0006\"B)N\u0001\u0004!\u0012AA5e\u0011\u0015\u0019V\n1\u0001\u0015\u0003!\u0001(/[8sSRL\b\"B+N\u0001\u00041\u0016!B9vKV,\u0007C\u0001\tX\u0013\tA&A\u0001\u0004QC\u000e\\W\r\u001e\u0005\u000656\u0003\r\u0001F\u0001\u0006G>,h\u000e\u001e\u0005\u00069\u0002!\t!X\u0001\u000eC\u0012$wk\u001c:lKJ$\u0016m]6\u0015\tiqv\f\u0019\u0005\u0006#n\u0003\r\u0001\u0006\u0005\u0006'n\u0003\r\u0001\u0006\u0005\u0006+n\u0003\rA\u0016\u0005\u0006E\u0002!\taY\u0001\u000fC\u0012$\u0007*\u00198eY\u0016\u0014H+Y:l)\u0011QB-\u001a4\t\u000bE\u000b\u0007\u0019\u0001\u000b\t\u000bM\u000b\u0007\u0019\u0001\u000b\t\u000bU\u000b\u0007\u0019\u0001,\t\u000b!\u0004A\u0011A5\u0002\u001b\u0005$G\rR3wS\u000e,G+Y:l)\u0011Q\"n\u001b7\t\u000bE;\u0007\u0019\u0001\u000b\t\u000bM;\u0007\u0019\u0001\u000b\t\u000bU;\u0007\u0019\u0001,\t\u000b9\u0004A\u0011A8\u0002\u001d\u0005$GMU;o]&tw\rV1tWR)!\u0004]9sg\")\u0011+\u001ca\u0001)!)1+\u001ca\u0001)!)Q+\u001ca\u0001-\")A/\u001ca\u0001k\u0006!A/Y:l!\t\u0001b/\u0003\u0002x\u0005\t!A+Y:l\u0011\u0015I\b\u0001\"\u0001{\u0003\u001d\tG\r\u001a+bg.$RAG>}{zDQ!\u0015=A\u0002QAQa\u0015=A\u0002QAQ!\u0016=A\u0002YCQ\u0001\u001e=A\u0002UDq!!\u0001\u0001\t\u0003\t\u0019!\u0001\u0005tG\",G-\u001e7f)\u0005Q\u0002bBA\u0004\u0001\u0011\u0005\u0011\u0011B\u0001\be\u0016dW-Y:f)\ra\u00131\u0002\u0005\u0007#\u0006\u0015\u0001\u0019\u0001\u000b\t\u000f\u0005=\u0001\u0001\"\u0001\u0002\u0012\u0005Y\u0001n\u001c7e\u0007V\u0014(/\u001a8u)\u0005a\u0003bBA\u000b\u0001\u0011\u0005\u0011\u0011C\u0001\u000fgV\u001c\b/\u001a8e\u0007V\u0014(/\u001a8u\u0011\u0019)\u0006\u0001\"\u0001\u0002\u001aQ\u0019A&a\u0007\t\u000f\u0005u\u0011q\u0003a\u0001-\u00061\u0001/Y2lKR\u0004")
public class Scheduler {
    private int queueCount = 0;
    private int holdCount = 0;
    private TaskControlBlock currentTcb = null;
    private int currentId = 0;
    private TaskControlBlock list = null;
    private final TaskControlBlock[] blocks = new TaskControlBlock[6];

    public int queueCount() {
        return this.queueCount;
    }

    public void queueCount_$eq(int x$1) {
        this.queueCount = x$1;
    }

    public int holdCount() {
        return this.holdCount;
    }

    public void holdCount_$eq(int x$1) {
        this.holdCount = x$1;
    }

    public TaskControlBlock currentTcb() {
        return this.currentTcb;
    }

    public void currentTcb_$eq(TaskControlBlock x$1) {
        this.currentTcb = x$1;
    }

    public int currentId() {
        return this.currentId;
    }

    public void currentId_$eq(int x$1) {
        this.currentId = x$1;
    }

    public TaskControlBlock list() {
        return this.list;
    }

    public void list_$eq(TaskControlBlock x$1) {
        this.list = x$1;
    }

    public TaskControlBlock[] blocks() {
        return this.blocks;
    }

    public void addIdleTask(int id, int priority, Packet queue, int count) {
        this.addRunningTask(id, priority, queue, new IdleTask(this, 1, count));
    }

    public void addWorkerTask(int id, int priority, Packet queue) {
        this.addTask(id, priority, queue, new WorkerTask(this, 2, 0));
    }

    public void addHandlerTask(int id, int priority, Packet queue) {
        this.addTask(id, priority, queue, new HandlerTask(this));
    }

    public void addDeviceTask(int id, int priority, Packet queue) {
        this.addTask(id, priority, queue, new DeviceTask(this));
    }

    public void addRunningTask(int id, int priority, Packet queue, Task task) {
        this.addTask(id, priority, queue, task);
        this.currentTcb().setRunning();
    }

    public void addTask(int id, int priority, Packet queue, Task task) {
        this.currentTcb_$eq(new TaskControlBlock(this.list(), id, priority, queue, task));
        this.list_$eq(this.currentTcb());
        this.blocks()[id] = this.currentTcb();
    }

    public void schedule() {
        this.currentTcb_$eq(this.list());
        while (this.currentTcb() != null) {
            if (this.currentTcb().isHeldOrSuspended()) {
                this.currentTcb_$eq(this.currentTcb().link());
                continue;
            }
            this.currentId_$eq(this.currentTcb().id());
            this.currentTcb_$eq(this.currentTcb().run());
        }
        return;
    }

    public TaskControlBlock release(int id) {
        TaskControlBlock taskControlBlock;
        TaskControlBlock tcb = this.blocks()[id];
        if (tcb == null) {
            taskControlBlock = tcb;
        } else {
            tcb.markAsNotHeld();
            taskControlBlock = tcb.priority() > this.currentTcb().priority() ? tcb : this.currentTcb();
        }
        return taskControlBlock;
    }

    public TaskControlBlock holdCurrent() {
        this.holdCount_$eq(this.holdCount() + 1);
        this.currentTcb().markAsHeld();
        return this.currentTcb().link();
    }

    public TaskControlBlock suspendCurrent() {
        this.currentTcb().markAsSuspended();
        return this.currentTcb();
    }

    public TaskControlBlock queue(Packet packet) {
        TaskControlBlock taskControlBlock;
        TaskControlBlock t = this.blocks()[packet.id()];
        if (t == null) {
            taskControlBlock = t;
        } else {
            this.queueCount_$eq(this.queueCount() + 1);
            packet.link_$eq(null);
            packet.id_$eq(this.currentId());
            taskControlBlock = t.checkPriorityAdd(this.currentTcb(), packet);
        }
        return taskControlBlock;
    }
}
